<!-- Secção de Testemunhos - TrataMentes -->
<section class="testimonials-section section" id="testemunhos">
    <div class="container">
        <header class="section-header has-text-centered">
            <h2 class="title is-2">O Que Dizem os Nossos Pacientes</h2>
            <p class="subtitle is-4">Testemunhos reais de pessoas que recuperaram a qualidade de vida</p>
        </header>

        <!-- Widget Elfsight para Google Reviews -->
        <div class="testimonials-widget">
            <!-- Placeholder enquanto carrega -->
            <div id="testimonials-placeholder" class="testimonials-placeholder">
                <div class="placeholder-content">
                    <div class="placeholder-stars">
                        <span class="star">⭐</span>
                        <span class="star">⭐</span>
                        <span class="star">⭐</span>
                        <span class="star">⭐</span>
                        <span class="star">⭐</span>
                    </div>
                    <p class="placeholder-text">A carregar testemunhos...</p>
                    <div class="placeholder-loading">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Widget Elfsight - Substitua WIDGET_ID pelo seu ID real -->
            <script src="https://static.elfsight.com/platform/platform.js" data-use-service-core defer></script>
            <div class="elfsight-app-WIDGET_ID" data-elfsight-app-lazy></div>
        </div>

        <!-- Testemunhos de Backup (caso o widget não carregue) -->
        <div id="backup-testimonials" class="backup-testimonials" style="display: none;">
            <div class="columns is-multiline">
                <div class="column is-half-tablet is-one-third-desktop">
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                        </div>
                        <blockquote class="testimonial-text">
                            "Depois de anos com dores nas costas, finalmente encontrei alívio. O João é um profissional excecional."
                        </blockquote>
                        <cite class="testimonial-author">
                            <strong>Maria S.</strong>
                            <span class="testimonial-location">Lisboa</span>
                        </cite>
                    </div>
                </div>
                
                <div class="column is-half-tablet is-one-third-desktop">
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                        </div>
                        <blockquote class="testimonial-text">
                            "Tratamento personalizado e resultados incríveis. Recomendo vivamente!"
                        </blockquote>
                        <cite class="testimonial-author">
                            <strong>Carlos M.</strong>
                            <span class="testimonial-location">Cascais</span>
                        </cite>
                    </div>
                </div>
                
                <div class="column is-half-tablet is-one-third-desktop">
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                            <span class="star">⭐</span>
                        </div>
                        <blockquote class="testimonial-text">
                            "Ambiente acolhedor e técnicas eficazes. Sinto-me renovada após cada sessão."
                        </blockquote>
                        <cite class="testimonial-author">
                            <strong>Ana P.</strong>
                            <span class="testimonial-location">Lisboa</span>
                        </cite>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call to Action -->
        <div class="testimonials-cta has-text-centered">
            <h3 class="title is-4">Quer Ser o Próximo Caso de Sucesso?</h3>
            <p class="subtitle is-6">Junte-se aos centenas de pacientes que já recuperaram a qualidade de vida</p>
            <div class="buttons is-centered">
                <button class="button is-primary is-large btn-agendamento" 
                        onclick="openBookingModal('', 'consulta-inicial')"
                        data-service="consulta-inicial">
                    <span class="icon">
                        <i class="fas fa-calendar-plus"></i>
                    </span>
                    <span>Agendar Consulta</span>
                </button>
                <a href="tel:+351937543312" class="button is-link is-large" onclick="trackEvent('phone_call')">
                    <span class="icon">
                        <i class="fas fa-phone"></i>
                    </span>
                    <span>+351 937 543 312</span>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- CSS para Testemunhos -->
<style>
.testimonials-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    padding: 4rem 0;
}

.section-header {
    margin-bottom: 3rem;
}

.testimonials-widget {
    margin-bottom: 3rem;
    position: relative;
}

/* Placeholder enquanto carrega */
.testimonials-placeholder {
    background: white;
    border-radius: 12px;
    padding: 3rem;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

.placeholder-stars {
    font-size: 2rem;
    margin-bottom: 1rem;
}

.placeholder-stars .star {
    color: #E8C547;
    margin: 0 0.2rem;
}

.placeholder-text {
    font-size: 1.1rem;
    color: #666;
    margin-bottom: 1rem;
}

.loading-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #2C5F63;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Testemunhos de backup */
.backup-testimonials {
    margin-top: 2rem;
}

.testimonial-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    height: 100%;
    display: flex;
    flex-direction: column;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.testimonial-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.testimonial-rating {
    font-size: 1.2rem;
    margin-bottom: 1rem;
    text-align: center;
}

.testimonial-rating .star {
    color: #E8C547;
    margin: 0 0.1rem;
}

.testimonial-text {
    font-style: italic;
    font-size: 1.1rem;
    line-height: 1.6;
    color: #333;
    margin-bottom: 1.5rem;
    flex-grow: 1;
    text-align: center;
}

.testimonial-text::before {
    content: '"';
    font-size: 2rem;
    color: #2C5F63;
    opacity: 0.3;
}

.testimonial-text::after {
    content: '"';
    font-size: 2rem;
    color: #2C5F63;
    opacity: 0.3;
}

.testimonial-author {
    text-align: center;
    font-style: normal;
}

.testimonial-author strong {
    display: block;
    color: #2C5F63;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
}

.testimonial-location {
    color: #666;
    font-size: 0.9rem;
}

/* CTA dos testemunhos */
.testimonials-cta {
    background: white;
    border-radius: 12px;
    padding: 3rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-top: 3rem;
}

.testimonials-cta .title {
    color: #2C5F63;
    margin-bottom: 1rem;
}

.testimonials-cta .subtitle {
    color: #666;
    margin-bottom: 2rem;
}

/* Responsividade */
@media (max-width: 768px) {
    .testimonials-section {
        padding: 2rem 0;
    }
    
    .testimonials-placeholder,
    .testimonials-cta {
        padding: 2rem;
    }
    
    .testimonial-card {
        padding: 1.5rem;
    }
    
    .testimonials-cta .buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .testimonials-cta .button {
        width: 100%;
        max-width: 300px;
        margin-bottom: 1rem;
    }
}

/* Esconder placeholder quando widget carrega */
.elfsight-app-WIDGET_ID:not(:empty) ~ #testimonials-placeholder {
    display: none;
}
</style>

<!-- JavaScript para Testemunhos -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Timeout para mostrar testemunhos de backup se widget não carregar
    setTimeout(function() {
        const elfsightWidget = document.querySelector('.elfsight-app-WIDGET_ID');
        const placeholder = document.getElementById('testimonials-placeholder');
        const backupTestimonials = document.getElementById('backup-testimonials');
        
        // Se o widget não carregou ou está vazio
        if (!elfsightWidget || elfsightWidget.children.length === 0) {
            if (placeholder) placeholder.style.display = 'none';
            if (backupTestimonials) backupTestimonials.style.display = 'block';
            
            // Track fallback usage
            if (typeof trackEvent === 'function') {
                trackEvent('testimonials_fallback', {
                    category: 'widget',
                    action: 'elfsight_failed'
                });
            }
        } else {
            // Widget carregou com sucesso
            if (placeholder) placeholder.style.display = 'none';
            
            // Track successful load
            if (typeof trackEvent === 'function') {
                trackEvent('testimonials_loaded', {
                    category: 'widget',
                    action: 'elfsight_success'
                });
            }
        }
    }, 5000); // 5 segundos timeout
    
    // Observer para detectar quando o widget carrega
    if (window.IntersectionObserver) {
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(function(entry) {
                if (entry.isIntersecting) {
                    // Widget entrou na viewport
                    if (typeof trackEvent === 'function') {
                        trackEvent('testimonials_viewed', {
                            category: 'engagement',
                            action: 'testimonials_section_viewed'
                        });
                    }
                    observer.unobserve(entry.target);
                }
            });
        });
        
        const testimonialsSection = document.getElementById('testemunhos');
        if (testimonialsSection) {
            observer.observe(testimonialsSection);
        }
    }
});
</script>

<!-- Instruções de Implementação -->
<!--
PARA IMPLEMENTAR OS TESTEMUNHOS:

1. Substitua "WIDGET_ID" pelo seu ID real do Elfsight:
   - Vá para https://elfsight.com/
   - Crie um widget de Google Reviews
   - Copie o ID do widget
   - Substitua em: class="elfsight-app-WIDGET_ID"

2. Configure o widget no Elfsight:
   - Conecte à sua conta Google My Business
   - Escolha o design que combina com o site
   - Configure para mostrar 6-9 reviews
   - Ative auto-refresh para novos reviews

3. Personalize os testemunhos de backup:
   - Substitua pelos seus testemunhos reais
   - Use apenas reviews verificados do Google
   - Mantenha nomes abreviados (ex: "Maria S.")

4. Teste a implementação:
   - Verifique se o widget carrega
   - Teste o fallback (desative JavaScript)
   - Confirme tracking de eventos

5. Otimização:
   - O widget carrega de forma lazy (só quando visível)
   - Placeholder melhora a experiência de carregamento
   - Fallback garante que sempre há testemunhos visíveis
-->

