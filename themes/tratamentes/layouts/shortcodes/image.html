{{/* Shortcode para imagens responsivas com WebP - TrataMentes */}}
{{- $src := .Get "src" -}}
{{- $alt := .Get "alt" | default "Imagem TrataMentes" -}}
{{- $class := .Get "class" | default "" -}}
{{- $width := .Get "width" | default "800" -}}
{{- $height := .Get "height" | default "600" -}}
{{- $loading := .Get "loading" | default "lazy" -}}
{{- $placeholder := .Get "placeholder" | default "true" -}}
{{- $caption := .Get "caption" -}}

<figure class="image-container {{ $class }}" 
        style="aspect-ratio: {{ $width }}/{{ $height }};"
        role="img"
        aria-label="{{ $alt }}">
    
    {{- if eq $placeholder "true" -}}
    <div class="image-placeholder" aria-hidden="true">
        <div class="placeholder-content">
            <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M21 19V5C21 3.9 20.1 3 19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19ZM8.5 13.5L11 16.51L14.5 12L19 18H5L8.5 13.5Z" fill="#ccc"/>
            </svg>
            <span class="sr-only">A carregar imagem...</span>
        </div>
    </div>
    {{- end -}}
    
    <picture class="responsive-image">
        <source srcset="/images/webp/{{ $src }}.webp" type="image/webp">
        <img src="/images/{{ $src }}.jpg" 
             alt="{{ $alt }}"
             width="{{ $width }}"
             height="{{ $height }}"
             loading="{{ $loading }}"
             class="main-image"
             onload="this.parentElement.parentElement.classList.add('loaded')"
             onerror="this.parentElement.parentElement.classList.add('error')"
             decoding="async">
    </picture>
    
    {{- if $caption -}}
    <figcaption class="image-caption">
        {{ $caption }}
    </figcaption>
    {{- end -}}
</figure>

